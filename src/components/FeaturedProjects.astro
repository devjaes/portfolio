---
interface FeaturedProject {
  title: string;
  shortDesc: string;
  longDesc: string;
  tech: string[];
  link?: string;
  slug?: string;
  confidential?: boolean;
  image?: string;
}

const featuredProjects: FeaturedProject[] = [
  {
    title: "TAPinto.net",
    shortDesc: "Major US digital news platform serving high-traffic markets.",
    longDesc:
      "Core developer for a high-traffic US digital news platform serving millions of users. Engineered complex CMS modules for 12+ content types, integrated dynamic ad-serving systems, and optimized payment gateways, operating entirely in an English-first distributed team.",
    tech: ["React", "Ruby on Rails", "High Traffic"],
    link: "https://www.tapinto.net/",
    image: "/assets/tapinto.bmp",
  },
  {
    title: "Lideser Export ERP",
    shortDesc:
      "Architected a rapid migration of a legacy ERP to modern Clean Architecture.",
    longDesc:
      "Lead Architect for the critical migration of a legacy Export Management ERP. Successfully transitioned the monolithic system to a modern, scalable Clean Architecture (React 18 + Rails API) in a record 2-week timeframe, significantly reducing technical debt.",
    tech: ["Clean Architecture", "TypeScript", "NestJS", "PostgreSQL"],
    image: "/assets/lideser.png",
  },
  {
    title: "AI Code Quality Validator",
    shortDesc:
      "Internal tool to evaluate and benchmark LLM code generation quality.",
    longDesc:
      "Developed an innovative internal system designed to audit code generated by AI models. Implemented automated validation pipelines using AST analysis to ensure outputs met rigorous technical standards defined by Senior Tech Leads.",
    tech: ["AI Evaluation", "TypeScript", "AST Analysis"],
    confidential: true,
    image: "/assets/code-validator.webp",
  },
  {
    title: "Award-Winning Algorithms",
    shortDesc:
      "1st Place Algorithm Challenge & 3rd Place Fintech Innovation Contest.",
    longDesc:
      "Recognized for exceptional problem-solving skills with a 1st Place finish at a prestigious Algorithm Challenge and 3rd Place at a Fintech Innovation Contest focused on AI Integration. Demonstrated mastery in competitive programming and innovative financial technology solutions.",
    tech: ["Algorithms", "Problem Solving", "TypeScript"],
    image: "/assets/at-work.jpg",
  },
];
---

<section id="projects" class="section-spacing">
  <div class="container-custom">
    <!-- Section Header -->
    <div class="mb-12">
      <h2 class="text-3xl sm:text-4xl font-bold mb-4">Featured Work</h2>
      <p class="text-text-secondary max-w-2xl">
        Highlights from my professional career and personal achievements.
      </p>
    </div>

    <!-- Featured Projects Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      {
        featuredProjects.map((project, index) => {
          const isClickable =
            !project.confidential && (project.link || project.slug);
          const href =
            project.link ||
            (project.slug ? `/work/${project.slug}` : undefined);

          return (
            <article
              class:list={[
                "group relative rounded-xl border border-surface-border bg-surface/50 overflow-hidden transition-all duration-300",
                index === 0 ? "lg:col-span-2" : "",
                isClickable
                  ? "hover:border-accent-cyan/50 hover:bg-surface cursor-pointer"
                  : "hover:border-surface-light hover:bg-surface",
                project.confidential ? "opacity-90" : "",
              ]}
            >
              {/* Clickable wrapper */}
              {isClickable && href && (
                <a
                  href={href}
                  target={project.link ? "_blank" : undefined}
                  rel={project.link ? "noopener noreferrer" : undefined}
                  class="absolute inset-0 z-10"
                  aria-label={`View ${project.title}`}
                />
              )}

              {/* Image */}
              <div
                class:list={[
                  "relative overflow-hidden",
                  index === 0 ? "h-64 lg:h-72" : "h-48",
                ]}
              >
                <img
                  src={project.image}
                  alt={project.title}
                  class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
                />
                <div class="absolute inset-0 bg-gradient-to-t from-surface via-surface/50 to-transparent" />

                {/* Confidential Badge */}
                {project.confidential && (
                  <div class="absolute top-4 right-4 flex items-center gap-2 px-3 py-1.5 bg-surface/80 backdrop-blur-sm rounded-full border border-surface-border">
                    <svg
                      class="w-4 h-4 text-text-muted"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"
                      />
                    </svg>
                    <span class="text-xs font-medium text-text-muted">
                      Confidential
                    </span>
                  </div>
                )}

                {/* External link indicator */}
                {project.link && !project.confidential && (
                  <div class="absolute top-4 right-4 p-2 bg-surface/80 backdrop-blur-sm rounded-full border border-surface-border group-hover:border-accent-cyan/50 group-hover:bg-accent-cyan/10 transition-all">
                    <svg
                      class="w-4 h-4 text-text-muted group-hover:text-accent-cyan transition-colors"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"
                      />
                    </svg>
                  </div>
                )}
              </div>

              {/* Content */}
              <div class="p-6">
                <div class="flex items-start justify-between gap-4 mb-3">
                  <h3
                    class:list={[
                      "text-xl font-semibold transition-colors",
                      isClickable
                        ? "text-text-primary group-hover:text-accent-cyan"
                        : "text-text-primary",
                      project.confidential ? "text-text-secondary" : "",
                    ]}
                  >
                    {project.title}
                  </h3>

                  {/* Arrow indicator for clickable items */}
                  {isClickable && (
                    <div class="flex-shrink-0 p-2 rounded-lg border border-surface-border text-text-muted group-hover:text-accent-cyan group-hover:border-accent-cyan/50 transition-all group-hover:translate-x-1">
                      <svg
                        class="w-4 h-4"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          d="M17 8l4 4m0 0l-4 4m4-4H3"
                        />
                      </svg>
                    </div>
                  )}
                </div>

                {/* Description Container - Hover to Reveal Pattern */}
                <div class="description-container relative mb-4">
                  {/* Short Description - Visible by default, hidden on hover */}
                  <p
                    class:list={[
                      "short-desc transition-all duration-300 ease-in-out",
                      "opacity-100 group-hover:opacity-0",
                      "max-h-20 group-hover:max-h-0 overflow-hidden",
                      project.confidential
                        ? "text-text-muted"
                        : "text-text-secondary",
                    ]}
                  >
                    {project.shortDesc}
                  </p>

                  {/* Long Description - Hidden by default, visible on hover */}
                  <p
                    class:list={[
                      "long-desc transition-all duration-300 ease-in-out",
                      "opacity-0 group-hover:opacity-100",
                      "max-h-0 group-hover:max-h-96 overflow-hidden",
                      project.confidential
                        ? "text-text-muted"
                        : "text-text-secondary",
                    ]}
                  >
                    {project.longDesc}
                  </p>
                </div>

                {/* Tech Stack */}
                <div class="flex flex-wrap gap-2">
                  {project.tech.map((tech) => (
                    <span
                      class:list={[
                        "px-3 py-1 text-xs font-medium rounded-full border",
                        project.confidential
                          ? "bg-surface-light/50 text-text-muted border-surface-border/50"
                          : "bg-surface-light text-text-secondary border-surface-border",
                      ]}
                    >
                      {tech}
                    </span>
                  ))}
                </div>
              </div>
            </article>
          );
        })
      }
    </div>
  </div>
</section>

<style>
  /* Ensure smooth height transitions for the description container */
  .short-desc,
  .long-desc {
    will-change: opacity, transform;
  }

  /* Pointer events handling for smooth interaction */
  article:hover .short-desc {
    pointer-events: none;
  }

  article:not(:hover) .long-desc {
    pointer-events: none;
  }
</style>
